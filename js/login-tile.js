var test=false,isValidationErrors="true"===$("#isValidationErrors").val(),loginAuthCallBackURL=$("#loginAuthCallBackURL").val(),loginSpringSecCheckURL=$("#loginSpringSecCheckURL").val(),loginProductUpdateURL=$("#loginProductUpdateURL").val(),loginMemberLoginURL=$("#loginMemberLoginURL").val(),memAuthPageURL=$("#memAuthPageURL").val(),memAuthPageState=$("#memAuthPageState").val(),memAuthPageResponseType=$("#memAuthPageResponseType").val(),memClientId=$("#memClientId").val(),provLogin=$("#provLogin").val();$(window).load(function(){$("#loginUserNameInput").focus()});
$(document).ready(function(){function a(){$(this).qtip("destroy");$(this).removeClass("validationFail")}isValidationErrors||$("#authErrors").val("");var b=$("#showLvLogin").val(),c=$("#hasCookie").val(),d=$("#referred").val();$("#loginUserNameInput").on("keyup",function(){a()});"true"==d?$("#loginChanger").hide():$("#loginChanger").show();"false"==c?($("#combinedLoginContainer").hide(),$("#preLoginContainer").show()):"true"==b?($("#combinedLoginContainer").show(),$("#preLoginContainer").hide(),showLv()):
showProviderLogin();$("input:radio[name=discoProd]").on("click",function(){var a=$(this).val();saveCookieValue(a)});$("#loginPasswordInput").keyup(function(b){a();13==b.which&&($("#ajaxImage").show(),$(".frmLvLogin#loginForm").submit())});b=$(this).find("#authErrors").val();void 0==b?window.location=loginAuthCallBackURL:($("#ajaxImage").hide(),"Bad credentials"==b?$("#failReason").html("Invalid username or password, please try again."):$("#failReason").html(b))});
function showMainQuestion(){$("#combinedLoginContainer").hide();$("#preLoginContainer").show();return!1}function showLv(){$("#memberLogonMessage").hide();$("#nonMemberLogonMessage").show();$("#cookieIsDisc").hide();$("#cookieIsLv").show();$("#lvLoginContainer").show();$("#discoLoginContainer").html("");$("#discoLoginContainer").hide()}function showProviderLogin(){window.location=provLogin}
function loginSubmit(){isFormValid()&&($("#ajaxImage").show(),$.ajax({type:"POST",url:loginSpringSecCheckURL,data:$(".frmLvLogin#loginForm").serialize(),dataType:"HTML",success:function(a){a=$(a).find("#authErrors").val();void 0==a?window.location=loginAuthCallBackURL:($("#ajaxImage").hide(),"Bad credentials"==a?$("#failReason").html("Invalid username or password, please try again."):$("#failReason").html(a))},error:function(){$("#ajaxImage").hide()}}))}
function isFormValid(){var a=!1;$("#failReason").html("");$("#loginUserNameInput").qtip("destroy");$("#loginPasswordInput").qtip("destroy");var b=$("#loginUserNameInput").val(),c=$("#loginPasswordInput").val();""==b&&(showValidationTooltip("loginUserNameInput",$("#loginUserNameInput").attr("validationMessage")),$("#loginUserNameInput").addClass("validationFail"));""==c&&(showValidationTooltip("loginPasswordInput",$("#loginPasswordInput").attr("validationMessage")),$("#loginPasswordInput").addClass("validationFail"));
""!=b&&""!=c&&(a=!0);return a}function getIframeHtml(){return'<iframe class="inner" allowTransparency="true" frameborder="0" scrolling="no" src="'+getDiscoLoginUrl()+'" style="height: 250px;" />'}function getDiscoLoginUrl(){var a="";location.port&&(a=":"+location.port);return memAuthPageURL+"?client_id="+memClientId+"&state="+memAuthPageState+"&response_type="+memAuthPageResponseType+"&redirect_uri="+("https://"+document.domain+a+loginMemberLoginURL)}
function saveCookieValue(a){$.ajax({type:"POST",url:loginProductUpdateURL,data:{answer:a},success:function(){"Yes"==a?showProviderLogin():($("#preLoginContainer").hide(),$("#combinedLoginContainer").show(),showLv())},error:function(){$("#ajaxImage").hide()}})};